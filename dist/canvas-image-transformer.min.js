const CanvasImageTransformer=function(){const a=function(c,d,e,b){return(c<<24)+(d<<16)+(e<<8)+b},b=function(a,b,c,d){const e=4*(c+d*b);return[a[e]/255,a[e+1]/255,a[e+2]/255,a[e+3]/255]},c=function(a,b){this.getMatrixArray=function(){return a},this.getWidth=function(){return b}};return{colorToRGBA:function(a){return[255&a>>24,255&a>>16,255&a>>8,255&a]},rgbaToColor:a,createKernel:function(a,b){return new c(a,b)},imageToCanvas:function(a,b,c,d){d&&(a.width>a.height?c*=a.height/a.width:a.height>a.width&&(b*=a.width/a.height));var e=document.createElement("canvas");e.width=b,e.height=c;var f=e.getContext("2d");return f.drawImage(a,0,0,b,c),e},videoFrameToCanvas:function(a,b,c,d){d&&(a.videoWidth>a.videoHeight?c*=a.videoHeight/a.videoWidth:a.height>a.videoWidth&&(b*=a.videoWidth/a.videoHeight));var e=document.createElement("canvas");e.width=b,e.height=c;var f=e.getContext("2d");return f.drawImage(a,0,0,b,c),e},applyKernel:function(a,c){const d=a.getContext("2d"),e=d.getImageData(0,0,a.width,a.height).data,f=new Uint8ClampedArray(4*(a.width*a.height)),g=c.getWidth(),h=c.getMatrixArray();for(let d=0;d<a.height;d++)for(let c,i=0;i<a.width;i++){c=[0,0,0,0];for(let f=0;f<g;f++)for(let j=0;j<g;j++){const k=j+f*g,l=j-(g-1)/2,m=f-(g-1)/2;let n=i+l,o=d+m;if(0>n||0>o||n>=a.width||o>=a.height)continue;const p=b(e,a.width,n,o);c[0]+=h[k]*p[0],c[1]+=h[k]*p[1],c[2]+=h[k]*p[2],0===l&&0===m&&(c[3]=p[3])}const j=4*(i+d*a.width);f[j+0]=parseInt(255*c[0]),f[j+1]=parseInt(255*c[1]),f[j+2]=parseInt(255*c[2]),f[j+3]=parseInt(255*c[3])}return d.putImageData(new ImageData(f,a.width,a.height),0,0),a},toGrayscale:function(a){for(var b,c=a.getContext("2d"),d=c.getImageData(0,0,a.width,a.height),e=0;e<d.data.length;e+=4)b=parseInt(255*(.2126*(d.data[e]/255)+.7152*(d.data[e+1]/255)+.0722*(d.data[e+2]/255))),d.data[e]=b,d.data[e+1]=b,d.data[e+2]=b;return c.putImageData(d,0,0),a},toBlackAndWhite:function(a){for(var b,c=a.getContext("2d"),d=c.getImageData(0,0,a.width,a.height),e=0;e<d.data.length;e+=4)b=.2126*(d.data[e]/255)+.7152*(d.data[e+1]/255)+.0722*(d.data[e+2]/255),.5>b?(d.data[e]=0,d.data[e+1]=0,d.data[e+2]=0,d.data[e+3]=255):(d.data[e]=255,d.data[e+1]=255,d.data[e+2]=255,d.data[e+3]=255);return c.putImageData(d,0,0),a},computeColorFrequencyMap:function(b){for(var c,d=new Map,e=b.getContext("2d"),f=e.getImageData(0,0,b.width,b.height),g=0;g<f.data.length;g+=4)c=a(f.data[g],f.data[g+1],f.data[g+2],f.data[g+3]),d.has(c)?d.set(c,d.get(c)+1):d.set(c,1);return d}}}();"undefined"!=typeof module&&module.exports&&(module.exports=CanvasImageTransformer);