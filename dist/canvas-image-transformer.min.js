const CanvasImageTransformer=function(){const t=function(t,e,a,n){return(t<<24)+(e<<16)+(a<<8)+n},e=function(t,e,a,n){const r=4*(a+n*e);return[t[r]/255,t[r+1]/255,t[r+2]/255,t[r+3]/255]};return{colorToRGBA:function(t){return[t>>24&255,t>>16&255,t>>8&255,255&t]},rgbaToColor:t,createKernel:function(t,e){return new function(t,e){this.getMatrixArray=function(){return t},this.getWidth=function(){return e}}(t,e)},imageToCanvas:function(t,e,a,n){n&&(t.width>t.height?a*=t.height/t.width:t.height>t.width&&(e*=t.width/t.height));var r=document.createElement("canvas");return r.width=e,r.height=a,r.getContext("2d").drawImage(t,0,0,e,a),r},videoFrameToCanvas:function(t,e,a,n){n&&(t.videoWidth>t.videoHeight?a*=t.videoHeight/t.videoWidth:t.height>t.videoWidth&&(e*=t.videoWidth/t.videoHeight));var r=document.createElement("canvas");return r.width=e,r.height=a,r.getContext("2d").drawImage(t,0,0,e,a),r},applyKernel:function(t,a){const n=t.getContext("2d"),r=n.getImageData(0,0,t.width,t.height).data,d=new Uint8ClampedArray(t.width*t.height*4),i=a.getWidth(),o=a.getMatrixArray();for(let h=0;h<t.height;h++)for(let a=0;a<t.width;a++){let n=[0,0,0,0];for(let d=0;d<i;d++)for(let g=0;g<i;g++){const u=g+d*i,c=g-(i-1)/2,s=d-(i-1)/2;let f=a+c,m=h+s;if(f<0||m<0||f>=t.width||m>=t.height)continue;const l=e(r,t.width,f,m);n[0]+=o[u]*l[0],n[1]+=o[u]*l[1],n[2]+=o[u]*l[2],0===c&&0===s&&(n[3]=l[3])}const g=4*(a+h*t.width);d[g+0]=parseInt(255*n[0]),d[g+1]=parseInt(255*n[1]),d[g+2]=parseInt(255*n[2]),d[g+3]=parseInt(255*n[3])}return n.putImageData(new ImageData(d,t.width,t.height),0,0),t},toGrayscale:function(t){for(var e=t.getContext("2d"),a=e.getImageData(0,0,t.width,t.height),n=0;n<a.data.length;n+=4){var r=parseInt(255*(a.data[n]/255*.2126+a.data[n+1]/255*.7152+a.data[n+2]/255*.0722));a.data[n]=r,a.data[n+1]=r,a.data[n+2]=r}return e.putImageData(a,0,0),t},toBlackAndWhite:function(t){for(var e=t.getContext("2d"),a=e.getImageData(0,0,t.width,t.height),n=0;n<a.data.length;n+=4){a.data[n]/255*.2126+a.data[n+1]/255*.7152+a.data[n+2]/255*.0722<.5?(a.data[n]=0,a.data[n+1]=0,a.data[n+2]=0,a.data[n+3]=255):(a.data[n]=255,a.data[n+1]=255,a.data[n+2]=255,a.data[n+3]=255)}return e.putImageData(a,0,0),t},computeColorFrequencyMap:function(e){for(var a=new Map,n=e.getContext("2d").getImageData(0,0,e.width,e.height),r=0;r<n.data.length;r+=4){var d=t(n.data[r],n.data[r+1],n.data[r+2],n.data[r+3]);a.has(d)?a.set(d,a.get(d)+1):a.set(d,1)}return a}}}();"undefined"!=typeof module&&module.exports&&(module.exports=CanvasImageTransformer);